
```{r}
#| label: load-packages

library(tidyverse)
library(knitr)
```


```{r}
#| label: load-data

load("~/sta470case1/data/yeast.RData")
yeast <- y
```

```{r}
#| label: nnn-dist

yeast |> ggplot(aes(x = nNN50)) +
  geom_histogram() +
  facet_wrap(~ uniqueWell)
```

```{r}
#| label: pca-area-concavity
unique_wells <- unique(yeast$uniqueWell)

pca_scores <- tibble(PC1 = c(), PC2 = c())

for(unique_well in unique_wells) {
  temp_pca_results <- prcomp(yeast |> filter(uniqueWell == unique_well) |> select(!c(strain, uniqueWell, uniqueImage, uniqueID)), scale = TRUE)
  temp_pca_scores <- data.frame(pca_results$x[, 1:2]) |> summarize(PC1 = sum(PC1), PC2 = sum(PC2))
  rownames(temp_pca_scores) <- unique_well
  
  pca_scores <- rbind(pca_scores, temp_pca_scores)
}


```

